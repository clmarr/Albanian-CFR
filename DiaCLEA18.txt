$ This cascade is primarily based off of BaseCLEA18, debugging it using DiaSim and its diagnostics. 

$ On stages/periodization, see file "Periodization policy"

$ "DV-NOTATION" for indexing De Vaan 2018 rules -- DV####.ɑβɣ##. -- DV for De Vaan, ### is page number, ɑβɣ is an alphabetic index in (A, B, C...) for each transformation on the page (starting with A, etc...), and   the number is the line of that transformation on that page. 

$TODO incorporate relevant TODOs (TODO FOR DIA, IMPLEMENT FOR DIA etc...) 

$--------------------Antique Proto-Albanian----------------------
=Antique Proto-Albanian

$$|| Latin Input handling|| 
$  rules following here are not core aspects of De Vaan 2018's proposed rules, 
$	but they are necessary to get the right outcomes,
$	i.e. to prevent errors that are "uninteresting"
$	some are drawn from our knowledge of what was going on within Latin
$	they are certainly subject to inspection and possible critique
$	many are nonetheless clearly assumed by De Vaan 2018 in terms of how he treats the nature of the input to rules he does explicate

$ general rule for De Vaan(:1747) is no change in stress placement: by default, Latin loans have the same stress placement as in Classical Latin, "and the same goes for loanwords from later layers... Slavic, Italian... Greek... Turkish". Exceptions seem to be largely morphologically motivated (see bottom of p1747); De Vaan (1747) agrees with Matzinger 2006 that things are too complicated for Jokl 1923's treatment of PPAlb as having general penultimate accent. 

$DIACLEA CORRECTION: pʰ > f, even if tʰ > t and kʰ > k
	$  Aromanian has shcl'ifur but Romanian has only palanga > pǎrângǎ (like Albanian also has p- in cognat plengë). 
pʰ > f

$ Deaspiration: this may or (more probably) may not have been contemporaneous with the merger of PIE aspirate voiced stops into 
$	simple voiced stops, but clearly Greek loanwords in Romance with aspirate voiceless stops became simple voiceless in/by the 2nd cent CE
$		cf. Pope 1934 p226 s629
$	however inclusion in the Albanian cascade is specifically justified by the treatment of OGr loans into Albanian by De Vaan 2018
$		e.g. De Vaan 2018 p1739 ~ DV1739.A4 -- mokër "millstone" Doric *mākhānā
$ corresponds to Orel 1.4.7.1 
[+sg,-cont] > [-sg]

$ Greek 'y' becomes i, likewise for the long-variant (praebyter > prift, etc.) 
[+front,+syl] > [-round,-lab]

$ g before n is ŋ -- Pope 1934(: p75 s158, p133 s321); Allen 1978 p23; Lloyd 1987 p81)
$ not made explicit by De Vaan -- henceforth Latin ɡn as discussed by him can be assumed to represent ŋn. In Romanian these clusters (later) become mn or m- (agnellus > miel, signum > semn, cognatus > cumnat...), but for Albanian De Vaan later assigns these as going to /ɲ/. 
ɡ > ŋ / __ n

$ Latin(-internal?) NASAL FRICATIVE PHENOMENON : Latin nasals lost before fricatives, making a prior vowel long if there was a prior V. 
	$ an input assumption for DV1735.D4. wrt krushk "in-law" < CONSOCER 
	$ some assert these long V-s would have gone through a stage of nasality for the vowels, but De Vaan does not consider this 
		$ relevant for Albanian outcomes
		$ inquiry into whether occasional Gheg nasality in these places (there are some 20-30 relevant words, at least can be systematically handled would be interesting -- it seems generally they are not nasalized) 
	$ cf Pope 1934 s359 (as a "very early" phenomenon in Latin), also p73 s156ii; also Allen 1978(:27-31, 55-6). 
		$ Shared with Romanian apparently. 
		$ Per Allen, Vaananen etc 
	$ different handling in corresponding Orel 1.4.7.13 on p115 in ns > ʃ
	$ this should not be formulated and sequenced so as to be fed by De Vaan 2018's one step passage of his PPAlb *tɕ *dʝ > *θ *ð, so that is placed afterward  (just because this is not indicated -- if there is evidence for it this would merit a change in treatment)
$DIACLEA RELOCDATION B1.I: moved this to after the pre-penultimate o/o:>u phenomena. As of June 17 -- reverted, returned to normal position
[+syl] n > [+long] ∅ / __ [-son,+cont]

$ DIACLEA INSERTION: A2.IV. Latin -ˈVolV(C)# items shift the stress onto the -o-, even though it is short. This is actually seen in the Romance languages too it seems (Seen in modiolus, filiolus, caveola, capreolus, phaseolus, gladiolus, etc...)   so it is placed into Latin input handling. 
[+prim] o > [-stres] [+prim] / __ l [-stres] ([+cons]) #

$DIACLEA INSERTION: the prefix ex- [eks-] is treated as es-, seemingly across Romance. Tempting to broaden this to all unstressed #Vx- onsets, but there's the possibility that rounding of axungia > ushu(n)jë is due to a labial element reflecting the -k- (cf. Romanian osânzǎ, cognate, too). 
k > ∅ / # [+front,-hi,-lo] __ s

$ -- end of Latin input handling --- 

$Latin ae basically always falls in with Latin short e so that is handled early on here -- thus implementing parts of the following: 2.2.1B1, 2.2.1B2  
$ this is not outright stated for 2.2.1A3 (i-mutation on Latin e) but there are no counterexamples, while praebyter > prift may actually be an example. 
$ however this could possibly counterfeed 2.2.1C5 (caelvm > qiell), depending on how it is construed -- however currently it will be bled for that word by the development of L (probably correctly) 
[+lo,βstres,ɣprim] e̯ > ∅ [-tense,βstres,ɣprim]

$per Kortlandt 1987 p220 s4 -- final s is deleted. This has to be after the dissimilations (thi for PIE ancestor of Lat. sūs) but before delabialization of ū, Kortlandt argues. De Vaan 2018 doesn't list this rule and asserts that nouns tend to reflect the accusative (which Bonnet 1998 seems to agree with), but this is included at this place (after the first Latin wave) to enable nominative forms in the lexicon as well as other words ending in -s, from Latin, Ancient Greek, and PIE alike. Note that Kortlandt 1987 opposes the view that *s went to *h or to ∅ (via /h/ or otherwise) in any other position (contra Jokl 1937, Meyer 1891, Pedersen 1900 , probably also Orel 2000), which includes retracting his earlier 1986 published view on intervocalic *s reflecting as nothing (but cf. nosom > nahe > na?). Given De Vaan 2018's reference to Kortlandt 1987 as its main source of *s developments, this view is adopted within this cascade, for now at least. (Kortlandt's lexical-etymological views are not adopted unless explicitly endorsed by De Vaan 2017, as with deriving the modern Albanian proximals ky,kjo,këta,këto from Latin ECCVM, also the source of these velar proximal elements across Romance) 
$ ʃ and s both included to allow flexibility in place
$ FOR DIA: combined with final consonant deletions originally at the end of Antique Proto-Albanian to Middle Proto-Albanian changes ($bandaid implied elsehwere -- strip final s in inflectional endings, and then nasals, in that order)
[+strid,+cor,+cont] > ∅ / [-stres] ([+nas,+cons]) __ # 
[+nas,+cons] > ∅ / [-stres] __ #

$DV1744.D & DV1744.E1  --*tɕ *dʝ > *θ *ð -- for De Vaan, these happen in one step, without intermediate stages in alveolar or dental affricates. 
$ symbol defs and the IPA don't (most typically) use *tɕ *dʝ, these are expressed with c͡ç and ɟ͡ʝ for reasons discussed above in the formulation for DV4.3G1 & H1 
$ needs to come after the nasal-spirant law above in Latin input handling so as not to feed it. 
$ However, in light of the fact that Proto-Albanian loans reflecting PIE palatovelars reflect as ts dz in Aromanian and various ts s z in Romanian (unlike PAlb ð < PPAlb *d, which reflects with d in Romanian and Aromanian), this is indeed split in two, with the affricate stage first, and the spirantization only after Middle Proto-Albanian (when De Vaan assigns the contact between Proto-Albanian and Proto-Vlach)
{c͡ç;ɟ͡ʝ} > {t͡s;d͡z}

$ DIACLEA insertion : in-metathesis or i-insertion in -- -Cina-/-Cinia rule (or -ina- metathesis? 
	$ the "maybe-metathesis" rule? (see below), occurring after back elements or strings of non-front elements that include at least one voiced labial element not separated by an obstruent from the target 
$ TODO does seem to happen after aw > a, so consider either relocdating that earlier into the end of Antique Proto-Albanian, or moving this -- and the relevant vowel drops -- later...
$ results when the /i/ is stressed are unclear -- which is why this is a "maybe metathesis" rule
	$ if it is really metathesis, we should see -ní(jë), with the n possibly going to -r- in Tosk when conditioned. This is possible what we see in porrˈīna > *porrinˈiːa > purri(-a) and maybe its possible variant prijë. But prijë could also be explained as coming from a prinjë, which matches the non-metathesis scenario that seems evident in marruːcˈiːna > mërqinjë, where it seems the original i maintains its stress, rather than switching with the n (along with the insertion of an i before the n). On the other hand columbīna > kullumbrí is a clear case of what looks more like metathesis. Seeing as -injë is a rather common suffix, it's possible merqinjë was analogized, so we are going with the -metathesis scenario for now -- that is (ˈ)ina > in(ˈ)ia, not (ˈ)ina > (ˈ)inia
	$ inasmuch as ia > e is plausible for Romanian, may also be evident in Romanian and Aromanian (?) -- marrucina > Alb mërqinjë, Romanian mărăcine (albeit also mărăcină), Aromanian mărăține. Alas this rule may not be worth it at all... 
$TODO ... is this rule *really* worth its cost in complication? Consider removing it. 
{i n;ˈiː n} > {i n i;i n ˈiː} / {# ([-front])* [+lab,+voi] ([+son])*;[+back]}  __ [+lo]

$DV1740I1 -- initial PPAlb and Lat. r- becomes "*r:"; merges with the reflex of PPAlb initial *wr- (DV1740I2)
$form prior to 8/5/23 was: (w) r > rː / # __ 
$changed to sidestep then-current input-side issues in DiaSim. TODO consider restoring when these are resolved. 
{w r;r} > {rː;rː} / # __

$DV1740I3 -- internal Lat. -rr- becomes PAlb *r: as well. 
r r > rː 

$DV1740G3 -- PPAlb *-rj- to ʎ. Does not seem (?) intended to be fed by gliding of Latin i,e in hiatus to j, which is below (GLIDING) -- Latin to PAlb etyma listed by De Vaan are clearly unaffected (altarivm p1737; febrvārivs p1745...). Cited to Bonnet 1998: 208ff; Matzinger 2006: 74. 
$ can be put here before the gliding of Latin i and e.  
r j > ʎ / @ __ @

$$ De Vaan 2018 has the change in vowel length to quality only come after major PPAlb to PAlb developments -- see p1736 -- namely long round vowel fronting, ai > ē, and aː > ɔː. -- will be handled in next stage

$ GLIDING -- gliding of unstressed /i/ and /e/ in hiatus with a following vowel to [j] -- cf. Pope 1934 s220. This is attested early but not trivially early -- it is in the Appendix Probi, as Pope 1934(:s220) notes. De Vaan 2018(:1744) seems to implicate this had occurred 
$ by listing DIĀNA and GAVDIVM as having Latin -dj- and likewise -tj- for PUTEVS, VITIVM, PATIOR, and MARTIVS. However, this needs to 
$ be placed before the fates of intervocalic obstruents are handled, as De Vaan does not seem to treat words    like GAVDIVM as having 
$ intervocalic -d-, for example, and this does clearly bleed his proposed rules for intervocalic /d/ in particular, if we assume its 
$ accuracy. Likewise these must also come before De Vaan 2018(: 1740)'s rules for Latin intervocalic /l/, as they feed the formation 
$ of PAlb *ʎ and *ɲ, and bleed the formation of *l:.  
$ for convenience, and given Pope 1934(:s220), and given that forming a broad rule is trivial here, the same is done for /u/ and /o/. 
	$ inasmuch as Latin orthographic V was used for both, there is perhaps mild support for De Vaan 2018 also having this here, 
		$ as informed by the handling of betacism of V (De Vaan 2018: 1744 -- DV1744.C1) 
$DIACLEA18 change: changed the -prim to -stress here as this doesn't seem to apply to countertonics as the diagnostics reveal a 0% accuracy over this subset -- especially looking at the cases of gruilla, coopertūra, creāre... etc. 
[-lo,+syl,-stres] > [-syl,+hi,-long] / __ [+syl]

$DV1740F3 -- Lat *l > l: / V __ V[-front]
$ as long as the lambda forming rule DV1740G1 is placed before this, [-front] does not need to be explicated, which is useful because [a] may technically be treated as front depending on the current convention for Latin on the input side, but this does appear to occur before [a] ? (or not?) 
$ Combined with DV1740F1 ~ PPAlb *l, *sl > l: / V __ V[-front] 
$ form prior to 8/5/23 was: (s) > lː / [+syl] __ [+syl]
$changed to sidestep then-current input-side issues in DiaSim. TODO consider restoring when these are resolved. 
$ DIACLEA change : just having this go straight to dark L /lˠ/
$ DIACLEA change : placing this before {nl,ll} > l, which counterfeeds it, and thus also before lambdacism -- in order to do so, the posterior context is now also *explicitly* [-front] 
{s l;l} > {lˠ;lˠ} / [+syl] __ [+syl,-front] 

$DV1740E3 -- Lat ll > PAlb l. As [l] is a resonant, this will be totally bled by DV1740F2 if not placed before it.
$merge with DV1740E1: PPAlb ln > PAlb l; placement for the same counterbleeding reasons.  
$DIA RELOCDATION: but this does seem to feed lambdacism -- placed before lambdacism as otherwise lambdacism for -llj- segments will be lost due to hte current formulation of rule 14 (l [+cons,+son] > lː); could specify that rule for [-lat] for the second input segment, but it is simpler to just place this rule earlier. 
{l;n} > {∅;∅} / l __ 

$ DV1740G1 : intervocalic l becomes ʎ before front vowel.
$ DIA -- SUPPRESSED, see "Old_DV1740G1_notes", the one case where this works (vjej "I need") is in the same ˌɑ __ [+prim,+front] context that so many of the errors are, best move for now is just to suppress this. 
$l > ʎ / [+syl] __ [+syl,+front]

$ DV1740G2 : l j > ʎ in PPAlb and Lat. Seems intended to be fed by hiatus vowel gliding. 
l j > ʎ

$DV1740F2 -- l and a nearby resonant (Rl, lR) merge to become *l:. De Vaan lists parabola -> përrallë as his third example wihch would imply a treatment of /β/ (perhaps? if not /b/?) as a resonant, which could cause problems, but actually parabola > përrallë can be perfectly handled if it is placed before the fall of unstressed vowels.
$ but this must be placed after DV1740E3 and DV1740E1 as otherwise it would completely bleed them.
$ form prior to 8/5/23 was: {[+cons,+son] l;l [+cons,+son]} > lː
$changed to sidestep then-current input-side issues in DiaSim. TODO consider restoring when these are resolved.
$ DIA CHANGE: these go straight to lˠ, not lː
$ DIA CHANGE: these are suppressed as they were correct for only items in r l, leaving only those. 
$ [+cons,+son] l > lˠ
r l > lˠ
$ l [+cons,+son] > lˠ


$DIACLEA INSERTION: A2.VIII Latin o and oː alike are changed to short u before non-palatal sonorant consonants, in syllables that are antepenultimate or earlier (i.e. those that will not be final syllables in Late Proto-Albanian)
	$ this seems to be a change shared with Vlacho-Romance. 
	$ originally I thought this was a specifically pretonic development, which does describe the majority of cases, and all cases before /ɫ/ and /ŋ/, but there are exceptions -- fornice > furriq, compater > kumtër, computum > kumt, cˈonsocer > krushk (Romanian cuscru), mˈonachus > murg, cˈontrā > kundër, etc... 
	$ the appearance that it was pretonic is just an artefact of Latin's stress system, that tends to put stress on the penultimate syllable.
	$ this doesn't seem to happen to word-initial vowels; although many of these end up as /u/ (urdhër, urdhëroj, uroj, ullashtër)... it seems there are separate reasons for that. Though the case of ōrdinem is possibly part of this phenomenon. -- cf Meglenite úrdin. 
	$ this occurs before hte nasal-fricative phenomena of Latin, which means post-dating that because...
		$ this occurs AFTER the gliding of high vowels in hiatus, as pertains to the syllable counting for what is a valid target for this rule (pistoria > shterë, not shturë or shtyrë, etc)
	$ there are minor differences in the conditioning wrt to the five non-palatal sonorants here... 
		$ 1. for n and m, this also occurs in __ N C, even in penultimate syllables (concha > kungë, rombus > rrumb...) 
		$ 2. This does not happen to long ō before m: prōmitt-ere > premtoj, rōmānus > rëmër. Based on dhuroj < dōnāre, it does seem to occur for ō before n. 
		$ 3. In the case of items before ɫ and l, it does seem to be that this is just non-primary-stressed o/oː segments that are affected (amándola >mendull, but Volpulum > Volpull) 
$part I: implementing the rule for __ NC
$ as of June 2024 -- part one conditioning broadened to (r) N (V-stres) C, the rest are collapsed into unstressed o raising, the C simply being non-sonorants
[+round,-lo,-hi] > [+hi,-long] / @ __ (r) [+nas,+cons] ([-stres]) [-son]

$part II: implementing the DiaCLEA-inserted rule A2.VIII for m elsewhere, for /o/, antepenultimate or earlier. As of June 2024: suppressed.
$[+round,-long,-lo] > [+hi] / @ __ m ([-syl])* [+syl] ([-syl])* [+syl]

$part III: non-primary-stressed o and o: are affected before ɫ and l. As of June 2024: suppressed.
$[+round,-lo,-prim,-hi] > [+hi,-long] / @ __ [+lat,-front]

$part IV: implementing the default behavior of the rule, for the remaining (non-palatal) sonorants: rː, r, nː, n, ŋ. As of June 2024: suppressed.
$[+round,-lo,-hi] > [+hi,-long] / @ __ [+son,+cons,-lab,-front] ([-syl])* [+syl] ([-syl])* [+syl]

$DIACLEA CORRECTION A2.VIII new version -- o to o: always when countertonic now, except when after labial-sonorant (florīnum > flori, proximare > prozhëm, prodāre > prodhoj, maybe prōmitt-o > premtoj) or onset sonorant (rosalia > rrëshaj, rōmānus > remër/rëmër, notoj, rozhponjë...), if the following wherein it goes to ɔ instead. Handle the exception first then the rule, the exception falling to (ˌɔ). Not necessarily unstressed o -- daemonem > djemër not djemu/-ũ, consobrinus > kushëri not kushuri, etc. 
[+round,-prim,-hi] > [-tense] / {#;[+lab,-son]} [+son,+cor] __

$DIACLEA CORRECTION A2.VIIIa -- unstressed o to u in  __ R V-stres
o > u / __ [+son,+cor,-nas] [-stres]

$now the actual unstressed o > u rule A2.VIII. Apparently doesn't happen word initially.
[+round,+tense,-prim,+stres,-hi] > [+hi,-long] / @ __

$DV1740H2 -- rC, Cr > r. 
$ This one is likely very bugged and needs either suppression or massive fixes-- suppressed, in conference with De Vaan 8/9/23
$ TODO long term - -consider only applying it for -rs- and -sr- for pre-Latin etyma 
$ r [+cons] > r 
$ [+cons] r > r 

$ DIACLEA CORRECTION (insertion) -- disappearance of j after w -- 561 laqueum > lak, 551 quiētus > qetë, 932 salviella > shërbelë ; perhaps also broaden to cover alveolu > nullë "gum" if we believe in that etymology. Seems apparent in Romanian too : quiētus > (in-)cet. 
j > ∅ / w __ 

$TODO before w deletion and modification phenomena operate, there are some things that need to be fixed... 
	$ TODO 1 disappearance of w into vowel coloring in: 167 eruilla > rrylë, 189 februarius > f(ë)ruor (via ɒː ?), potentially others -- though not servitium > shërbes) 

$ DV1743.B4 -- w > b after r and l. I.e. the (non-nasal) (sonorant) coronals. 
$ DIACLEA fix: only after a non-initial vowel. (e.g. not februarius > fëruor, eruilla > rrylë, alveolus > unatt. llullë > nullë...) 
w > b / @ [+syl] [+cor,-nas,+son] __

$ De Vaan 2018 (: 1745 -- DV1745.A1) -- loss of Latin /w/ intervocalically: he cites qytet 'city' < CĪVITĀTEM, njerkë "stepmother" < NOVERCA
$ TODO RELOCDATE THIS LATER -- W phenomena including coloring stuff where this matters happen much later
w > ∅ / [+syl] __ [+syl]

$ De Vaan p1743-4 -- w dropped between k (DV1743.G2) or g (DV1744.A2), and vowels. This will eventually feed the palatalization of these velars before i/e/y (p1743) but this feeding does not have to be explicitly coded in. 
$ form prior to 8/5/23 was: {[-cont,+back] w;[-cont,+back,+round]} > {[-round] ∅;[-round]} / __ [-cons] 
$ was formulated so as to handle if these are treated instead as labialized consonants (alas in practice the format in ALLex currently is always "k w" and "ɡ w", not "kʷ", "ɡʷ".) 
$changed to sidestep then-current input-side issues in DiaSim. TODO consider restoring when these are resolved.
$ in practice qu- and gu- never occur without following vowels, so it can be expressed without the following vowel. 
$ TODO move   this later, or having relevant coloring phenomena operate beforehand (quīs > qysh, quadrum > kodër, quartus > kort, civitatem > qytet, eruilla >rrylë; lso possibly, with  the Xʷ(?), factūra > fytyrë and axungia >ushu(n)jë ~ Romanian osânză)
w > ∅ / [-cont,+back] __

$merger of three rules: DV1740.D1 -- PPAlb nj > ɲ; DV1740.D2 PPalb and Lat *gn- and -gn- > ɲ; DV1740.D3 -- (glided) Latin nj > n (from n (i,e) V) ; expanded to cover ŋ n too. 
$ DIACLEA CHANGE: decoupled these. Handling gn phenomena elsewhere, on the basis of cognatus > kunat, fuskina > fuzhnjë, etc. Furthermore in Romanian words in original -ŋn- reflect in mn or even m- (agnellus > miel) 
$kn and gn phenomena are now to be handled either in tandem with k/g(V-stres)t phenomena, or before APA. --
${ŋ n j;ŋ n;ɡ n j;ɡ n;n j} > {ɲ;ɲ;ɲ;ɲ;ɲ}
n j > ɲ 

$DV1740.D4 Lat -ng(u-)>ɲ / __ V[+front]
$ form prior to 8/5/23 was: [+nas] [-cont,+back,+voi] ([+hi,+round,-cons]) / __ [+front,-cons,+hi]
$now only doing the ng > ɲ aspect, as the loss of w after g is handled by DV1744.A2 above.
$[+hi,+round,-cons] > ∅ / [+nas] [-cont,+back,+voi] __ [+front,-cons,+hi]
[+nas] [-cont,+back,+voi] > ɲ / __ [+front,-cons,+hi]

$ DV1744.C4 -- emergence of PAlb β before Latin long ō and the reflex of Alb long-ā, but PPAlb ō is not listed. PAlb β itself is the reflex of initial Latin w- and PPAlb β, itself from a PIE u̯. Treat as w for now, betacize later, as then merge them here, with a single rule. In order to impact PPAlb ā and Latin ō but not PPAlb ō, PPAlb ō must have a different reflex at this stage. But De Vaan 2018 does not seem to PPAlb ō and Latin  differently otherwise, in fact they are typically handled together (cf. DV1736G1, DV2.2.1B7 & DV2.2.1B8) except when i-mutation is concerned (DV1736H1, which can simply be handled by placing it in the post-Greek but pre-Latin area of PAlb). So unless there are issues that emerge upon later examination, we will be treating PPAlb ō as potentially a trigger as well.
$ although is not explicitly stated, the examples all concern initial vowels. 
$ DIACLEA CORRECTION: also occurs before initial short /o/ too it seems.
$ TODO move this to a later time . 
$ TODO consider treating this as via diphthongization.
$ TODO doesn't seem to happen before labials for unstressed o (oblata > blatë, ofella > felë, though opera > vapër) 
∅ > w / # __ [-hi,+round]

$ DV1744.C1 : Lat. w- > β. 
$ TODO NOTE FOR DIA: this is redundant with the earlier rule doing the exact same thing to PIE u̯ > PPAlb β (DV1746.F1 = DV4.3L1), TODO consider merging these. 
$ note that the dating of this shift in Latin is quite antique -- 1st century, case of <nerβa> in a Latin inscription (otherwise from β?) -- though that is in the West. 
$ TODO actually, consider moving this later. 
w > β / # __

$ DV4.2F4: Lat. i- merges with PPAlb *ʒ as PAlb *ɟ; PPAlb *ʒ as PAlb *ɟ as implementing DV4.2F1
$ TODO FOR DIA ? : consider merging this with the j- > ɟ for PPAlb j-, and explain j reflexes of Latin glided i- (janar etc?)
j > ɟ / # __
ʒ > ɟ

$ DV1740.C1 & C3 (merged) -- -Tn- and -sn- > n:. Listed only for PPAlb not Latin; since no Latin etyma loaned to Albanian have these clusters before the vowel falls start, it is placed before them. It doesn't seem toeffect
$ The -nn- clusters from loans and also earlier assimilations are also swept up in this on purpose. 
$ DV1740.C2 merged in too -- -Kn- affected as well. But this should be interpreted as just targeting -kn- and not -gn-, because in DV1740D2 De Vaan notes that PPAlb and Lat gn- and -gn- clusters instead go to ɲ. Latinate loans into PPAlb have no -kn- clusters before the vowel drops, so it makes sense to implement this here. 
$ form prior to 8/5/23 was: {[+cor,+ant,-son];n;k} n > nː
$ was formulated so as to handle if these are treated instead as labialized consonants (alas in practice the format in ALLex currently is always "k w" and "ɡ w", not "kʷ", "ɡʷ".) 
$changed to sidestep then-current input-side issues in DiaSim. TODO consider restoring when these are resolved.
{s n;t n;d n;n n;k n} > {nː;nː;nː;nː;nː}

$TODO there is probably some way that vowels in hiatus are handled, rather than simple reduction. Come back to this. 

$----- early aspects of vowel reduction and falls ----- 

$ DV2.2.2c "at an early stage" internal unstressed post-tonic vowels go to schwa, some soon to be lost. 
$ originally formulated here so as to not count items with inflectional ending consonants (e.g. accusative -m) as "internal" : [-stres] > ə / [+prim] (@)* __ ([-syl])* [+syl] -- but now this is no longer necessary(?)
$ the vowel reduction and falls as a whole are said to happen "in the last phase of the Proto-Albanian period... after i-mutation and a-mutation" but it seems this does not apply to these early internal post-tonic reductions given the cited cases of lardh and verdh, nor to the internal pretonic vowels that are reduced to ə and/or "lost at a stage preceding PAlb" (with Latin etyma cited -- cotoneus > ftua, nepōtia > mbesë, etc.); note that APA is not strictly within De Vaan's "PAlb here". 
$ DIACLEA CHANGE C1B.III: does not seem to affect low-vowels at this point -- yet. In most cases it will evenutally , though. 
$ DIACLEA CHANGE D3.III: moved to (originally) second _VOWEL DROP WAVE_, although some of the effects placed not long after this at the beginning of Middle Proto-Albanian. There may still be some justification for 
$[-stres,-lo] > ə / [+prim] (@)* __ @ 


$--------------------Middle Proto-Albanian-------------------
=Middle Proto-Albanian
$ main wave of contact with Proto-Romanian (temporarily?) complete now
$ evidence from the loans indicates that around this time, the reflexes of hte PIE palatovelars in Alb should be around ts/dz (evidenced mainly by Aromanian as these deaffricate in Romanian), tentatively before the merger of PPAlb a: into o is complete (cf. mazăre for Alb modhull, rață for rosë "duck"), before the passage of PPAlb tʃ dʒ to s z (ciută -- sutë etc...), after the retraction of post-vocalic s (mosh "old") but before the same impact on cluster s including in Latin loans (strunga-shtrungë; Lat fossātum > ORom fsat, Alb fshat, Lat spodium > Alb shpuzë > Rom spuza), tentatively after the emergence of some schwa (Rom nǎpârcǎ -- Alb nëpërkë "adder" --though as of June 2024 this idea is set aside as the vowel reduction patterns of Rom and Alb are too different to warrant so much effort to reconcile them), after the emergence of Albanian suffix -zë, perhaps after the emergence of the Albanian postposed article in -të (Drobeta), at a point when initial PPAlb w is in the stage of [β] (Rom abur -- Alb avull "vapor", vatra-vatër) which closes to /b/ in Romanian just like PPAlb /ð/ (< intervocalic d) goes to PVlach /d/; before ALb long u: > y (ghiuj/gjysh, buc/byk... , the -i- in ghiuj probably for ohter reasons though that is certainly interesting...) 

$ resolution of DV1744.D & DV1744.E1 -- see notes on this above, this is motivated by the outcomes in Aromanian and Romanian of PPAlb ɟ͡ʝ vs. PPAlb d in cases where they both ended up as ð in Alb. 
{t͡s;d͡z} > {θ;ð}

$DIACLEA rule insertion: ʎ depalatalizes to l between high vowels
	$ note, does not seem to happen in Vlacho-Romance: peculium > Alb. pekul but Daco-Rom (dial.) picui & păcui and Aromanian picul'iǔ; milium > Alb mel but Drom mei and Arom mel'iǔ
	$ TODO there is some depalatalization of ʎ that remains unaccounted for ː favaliam > falë (unless this is fawʎə ??), oleaster > ullashtër (already u?) ... 
ʎ > l / [+hi] __ [+hi]

$ DV2.2.2c, resolution -- effacement of internal posttonic vowels is complete in time to block loss of d (> ð) in verdh and lardh, based on example words used. 
$DIACLEA CHANGE C3B.VIII: largely suppressed. Effects of this currently handled in second drop wave; some handled below, for non-low vowels, without a need to explicitly pass through schwa, for hte following contexts
	$ atonic (non-low) vowels in [+son] t/d __ k  
		$ d now removed as it appears that secondary(!) d (i) k clusters have voicing involved -- eradicare > rrëgjoj, medicastrum > mëgashtër , excaudicāre >shkagoj 
	$ atonic (non-low) vowels in r  __ [-son,-lab]
	$ non-primary (non-low) vowels in in k/g __ t/k(/d/g) V
	$atonic (non-low) vowels in V b/p/g/k __ [-voi,-lab] 
$ ə > ∅
[-stres,-lo] > ∅ / [+son] t __ k 
[-stres,-lo] > ∅ / r __ [-son,-lab]
[-prim,-lo] > ∅ / [+back,-cont] __ [-cont,-lab] [+syl]
[-stres,-lo] > ∅ / [+syl] [-cor,-cont] __ [-voi,-lab]

$TODO may need to implement voicing assimilation and other cluster fixes here... or later.

$ TODO need to work on this rule -- see "kt outcomes" file. 
$ k becoming yod before /t/ if next to front vowel -- De Vaan 2018(:1744)  -- DV1744.J3
	$ potentially IMPORTANT: what frontness should we treat /a/ as having at this point? For the inputs to Gallo-Romance, Pope 1934 treats Latin /a/ and /aː/ as originally backed, but becoming fronted... what should they be here?  
	$ given that he lists SANCTVS > shenjtë "holy, saint", this either ...
		$ (a) must be after VN coalescence, 
		$ (b) see through prior /n/, 
		$ or (c) that n must have become /ɲ/ ...?
	$ given the treatment of PAlb /ɲ/ on p1740, we can exclude (c), as it is not predicted to have emerged for this word in the post-Latin Proto-Albanian stage
	$ we'll formulate the rule to simultaneously entertain (a) and (b) by using an optional nasal placed intermediately for the prior conditioning
		$ as it is not among the listed sources of this. 
$ first part -- conditioning on front vowel or /a/, then /t/; using [-stres,-round] ([-stres] implies [+syl]), as it can be assumed there was no front round vowels yet.  Based on the example of cogitare, it seems expected that g is swept up in this. 
$ DIACLEA CORRECTION : the trigger is the more phonetically predictable front vowels here -- not [ə], and not [a]ǃ 
[+back,+cons] > j / __ [-stres,+front] t
$ second part -- prior conditioning
[+back,+cons] > j / [+front] ([+nas]) __ t

$part I of DV1736.G1 / DV2.2.1L1 has PPAlb ō and Lat ō, as well as Lat o, ultimately becoming *uo before word-final {ɫ,n,r,j}. For this to happen, they cannot be fronted to ø -- as is about to happen to long oː. At the same time, De Vaan does not list a *ɫ in Proto-Albanian or Proto-Albanian, though its sources are clear, coming from a PAlb *lː (DV1739~3.1E), itself with identifiable Pre-Proto-Albanian and Latin sources (DV1740~3.2F, cf. also -E). Makes sense to gather these as /lː/ for now, for the baseline cascade, before this rule. The *Rl aspect of it seems to come after consonantal reductionsː see De Vaan's listing of Latin PARABOLA > përrallë for DV1740~3.2F2. 
$note that this is not listed for the reflex of PPAlb *ā, which is currently *ɒː, but alas this item *does* get fronted to ø under i-mutation in DV2.2.1B7.
$TODO make sure the relevant rules concerning laterals are all placed before this! -- can remove when that is done. 
$What we need to do here: ensure that the relevant words can pass to *uo, and won't be bled by fronting to *ø, and we do this by effectively merging them into *ɒː, the reflex of PPAlb *ā. Use *lː for ɫ for now. Need to do this to o:, but not to short o. Allow presence of unstressed non-low vowel (which will fall before long), and a possible nasal following it, to express what will become final position, as they might not have fallen yet by this stage. 
$ DIACLEA FIX: now using lˠ not lː
$ DIACLEA FIX: in the case of -r, this does not seem to happen after continuants (nder, tmerr, vlerë, herë, mësherë...) 
[+round,+syl,-hi,-lo,+long] > [+lo] / __ {lˠ;n;j} ([+syl,-stres] ([+nas])) #
[+round,+syl,-hi,-lo,+long] > [+lo] / [-cont] __ r ([+syl,-stres] ([+nas])) #


$ TODO for reconsideration of the above... The listed words are: 
	$ /o/: solum > shuall "sole" 
	$ /oː/: cotōneus > ftua "quince", dracō (likely the accusative dracōnem) > drangue, duar (< ghesr- ...), and muaj. 
$ Albanian duar rather seems to reflect a *ɔː (> o) from *aː, that is not at risk of merging; muaj is unclear, but Latin oː clearly needs to be handled here
$ other relevant cases: 
	$ in oːn- : Latin capōnem > kapua "rooster", lacōnem > lëkue "water lily", leōnem > luan "lion" (corōnam > kurorë "crown, garland; wealth" is a later loan per Orel 2000(:33)), Antōnius > Ndue "Anthony", falcōnem > fajkua.
		$ cases where fronting does appear to occur: ratiōnem > arsye "reason" 
	$ in practice it doesn't seem this happens much before -ll and -r at this stage for the long oː but were going with this for now out of faithfulness .
		$TODO: remove this commentary from baseline 18 cascade once decisions are made for DiaCLEA, move it there. 

$DIACLEA INSERTION: aw-mutation? rounding and lowering of primary stressed unrounded long/tense (a:, o:, e:) vowels under the influence of a round vowel on the other side of an ɲ. 
$ inclusion of ō is unclear -- evidence does not point strongly either way. Excluding it would mean more conditions though. 
$ operation on ē does not happen after dentals and perhaps not after l-velar sequences (plac-ē- > pëlqej, indulg-ē- ndjej, perindulg- përdëllej; lk uncertain given plac-ē> pëlqej but mulc-ē > mëlkoj, mulkoj, but without pëlqej; one other issue is poenitere > pend-o- though this is only seen today in the reflexive pendohem and maybe it wouldn't apply given the different suffix in that case?). For now, for the sake of simplicity, just go with the coronal; for all we know, perhaps Alb. pëlqej is actually a cognate, not a reflex, of Latin placeo/placēre (the word apparently also exists in Tocharian)
	$ these same post coronal environments do see some -ej outcomes for the -ā- class too (simul-ā- > shëmbëllej, incausin-ā- > ngashërej, sper-ā- > shpërej ...) but only in 7 out of 76 cases.
$ During August 2023 it was thought that ɲ also depalatalized after original ō here but in further consideration, only two items are affected (antōnius, cotōneum) and these were able to be explained otherwise in a much more general rule conditioned by nasals, so this was removed on the 29th
$TODO this may operate around rj too for ā and maybe ō, with deletion of the -j- element in some cases. That merits more inspection. Definitely consider possibilities to reformulate this. 
[-hi,+long,+tense] > [+round,+lab,+lo] / __ ɲ [+round]

$ handling now the fork in the fate of ēɲ[round] -- alternatively, could do this by unrounding the unstressed final vowel trigger of this, and that is maybe more parsimonious (one less rule), but may not really be "kosher" so to speak as it is kind of hacky, perhaps. 
[+front,+lo,+round] > [-round,-lab,-lo] / [+cor] __
[+lo,+round] > [-front,+back]

$ De Vaan 1736 "1." + DV1736~A1&A3 (on Lat & PPAlb ū) + DV1735~A7&A8 (on Lat & PPAlb ō) - long back vowels fronted -- listing only the round ones and not including ɒː (incl. from PIE & AGk aː)-- in effect, he seems to mean the non-low long back vowels ones. 
[+back,+long,+syl,-lo] > [+front,-back]

$ De Vaan p1736 "2." +DV1735~A1&A2: PPAlb & Lat ai (incl ae?) > ē
$ based on treatment of Lat. ae elsewhere, where it falls in with Latin *short* e, it seems not, but this is bled already anyways so no need to change this rule at the moment (as of Aug. 1 2023) 
$ DIACLEA CORRECTION: this does not happen prevocalically (perhaps because the -j- is seen as an onset?) 
[+lo,+syl] [+front,-cons,-syl] > [-lo,-back,+front,+long] ∅ / __ {[-syl];#}

$ De Vaan p1736 "3." + DV1735C1 (PPAlb *ā)+ DV1739.A4 (on Gk mākhānā > mokër, but via PPAlb *ā) -- completion of ā > o phenomenon, via raising of ɒː to ɔː -- thus completing "ɑː > ɔː" as in his enumerated "3." at the bottom of 1736. 
[+round,+lo,+long] > [-lo,-tense]

$ 4 NEW VOWEL SYSTEM. loss of distinctive vowel length leading to "system"
$the following system will emerge per chart at bottom of 1736 -- filling changes not already handled before this point.
	$ (*ī>) /i/ 		(*ū >) (/u/ > /y/)
	$ (*i>) /ɪ/		(*u>) /ʊ/
	$ (*ai, *ē) > /e/  	(PPAlb *ō, Lat. o & ō >) o > ø	
	$ (*e) > /ɛ/ 		(PPAlb *ā, Lat. o & ō >) ɔ > o  
	$ (*a) > /a/ 

	$ he lists "Lat. o & ō" for both but this will be handled per the more indepth descriptions as supplied in the listed changes further above as appropriate. Ie DV1735A has really mainly Lat. ō going to ø > e... 

$handling the posited emergence of high lax vowels from older short high vowels as part of p1736's new vowel system.. Include also his e > ɛ shift here (listed above), and this will give us also o > ɔ too (not ʏ or œ since short versions of y and ø have no way to emerge at this stage.); the outcome of PPAlb/Greek ā (> ɒː) is already ɔː here but he mentions some Latin o & oː passing through "ɔ > o"; unclear when it raises again. 
[-lo,+syl,-long] > [-tense]

$then distinctive length is lost in vowels
$this effectively implements: DV2.2.1A2, part of DV2.2.1A4, DV2.2.1A6, DV2.2.1B3, part of DV2.2.1B4-8, DV2.2.1B10, part of DV2.2.1C4, part of DV2.2.1E1, DV2.2.1E3, part of DV2.2.1F1 & F3. 
[+syl] > [-long]

$DV2.2.1A4.II -- resolving raising before "sh" (which might still be [s] in this cascade) for Latin ē and PPAlb *e in this position (earlier lengthened to feed this, now both to [e] as the short variants are now [ɛ]) 
$TODO FOR DIA: note above that this may be more accurately captured as __ ʃj than simply __ ʃ , given eshkë, kreshmë, rrjesht and veshk. 
$DIACLEA FIX: this seems to actually just be i-mutation, as it only really seems to occur when there is a -j- in the next syllable. 
$[+stres,+tense,+front,-lab] > [+hi] / __ [+cont,-lab,+strid] ([+cons]) j

$ raising of ɔ to o seems implicit here as a PAlb *ɔ is not handled for following rules concerning words were it is supposed to have arisen... -- i.e. > ø under i-mutation (5a.iii on p1736; 1735DV.A6 on this for reflex of PPAlb aː), seen also in the formulation of o-breaking rules (DV1736~G1 & G2)... 
$ This can be handled in tandem with the raising of /ʊ/ back to /u/, which occurs for the reflexes of both Latin U and PPAlb *u (DV1735~2.2E1, -E2)
[+back,+syl] > [+tense]

$DIACLEA INSERTION -- A2.X -- ɪ goes back up to i before ʎ (5 known cases for ˈɪʎ, e.g. familia > fëmijë, scantilia > shkëndijë) and before labials (4 cases for ˈɪp and ˈɪf, ex. gripsa > grifshë). This is better not handled as part of i-mutation as some of the pre-labial cases don't work that way (gripsa > grifshë) and it appears that ʎ only triggers what looks like i-mutation for /ɪ/.   
$ TODO note that all cases except for grifshë can be counterexplained by i-mutation though. 
ˈɪ > ˈi / __ {ʎ;[+lab]}

$ It seems there is a difference between native and Latin *i outcomes --  DV1734~2.2A1: the former all end up as PAlb *i, but in DV1735~2.2A5 Latin /i/ only becomes PAlb *i with i-mutation, otherwise becoming *e (DV1735~2.2B11) 
$ TODO FOR DIA -- note that the data suggests it might be more complicated here... 
$ inasmuch as this is mainly a Latin to Albanian cascade endeavor at present, and no specific examples were given for native PPAlb *i having a different outcome from Latin I, precedence is given to the developments described for the latter.
$ This differs from the outcome for /ʊ/ from Latin or PPAlb *u, which both raise back to /u/ (DV1735~2.2E1, -E2), as seen with /ɔ/ to /o/, handled above. 
$ this thus implements DV2.2.1B11
[+syl,+hi,-tense] > [-hi,+tense]

$DIACLEA INSERTION : nw (or nβ) > m before [e], currently unspecified for stress though all cases seem to be before countertonic [ˌe]. This explains all nw > m cases except for the proposed etymology of invernālia for mërrajë. Motivation for this may be found in differentiating this from [ø], which in some accounts (e.g. Orel 2000) may have been [we] (note that the same sound becomes [uo] before sonorants). 
$ TODO maybe broaden this and have nɸ involved for cases like iūnctus 
n [+lab,-syl,+voi] > m / __ [+front,-hi,+tense]

$I-MUTATION HERE, since it can feed ietation/diphthongizations (in case of PPAlb a: > ɒː > ... > ye) and also bleed them. 
$this implements DV2.2.1A3,  DV2.2.1B4, DV2.2.1F2, 
$this is also part of the implementation of DV2.2.1A5,DV2.2.1B6, DV2.2.1L1, and DV1737's 5b.II 
$the contextual trigger for this is left somewhat vague, but examples given include __ n t ī, __ C j, __ C ɛ, __ C {ɪ/e}, and one case that will probably concern __ ʎ (DV2.2.1A5) .. so the context can be what is C j, ʎ, i e ɛ ɪ here. 
$it can be assumed this is intended as a law targeting stressed vowels, because it is placed in 2.2.1 "The stressed vowels of PAlb". No direct statement of ɲ being implicated.
$DIACLEA CHANGE: I-mutation is BLOCKED by preceding labials, and also no evidence it occurs word-initially.
$TODO IMPLEMENT FOR DIA : ē s (i,e,j) also is an i-mutation targetǃ -- later note...: perhaps ditch this as it is ... covered already by pre-ʃ phenomenon? TODO CHECK...
{ˈɑ;ˈo;ˈu;ˈe;ˈɛ} > {ˈe;ˈø;ˈy;ˈi;ˈi} / [-lab] __ ([-syl])* [+front,-round,-cons]

$ dj and tj merge into PAlb dʒ and tʃ, feeding their passage to z and s (DV1744.F1 = 4.2M1, 1744.F2 = 4.2M2, 1744.G1 = 4.2N1, 1744.G3 = 4.2N3) 
$ DIACLEA RELOCDATION B2.III -- bleeds nd > nt, so relocdated to just before it. As of June 11 2024, relocdated yet further to come before ietation, which it counterfeeds it (tegula > tjegull not segull, castellam > kështjell not këshsell, daemonem > djemër not zemër, though the last could be a later loan.). If this creates problems, another fix could be to make the j arising from hiatus into to a different element, perhaps a /ʝ/? This is currently placed after (in fact, right after) i-mutation, which may have different conditioning effects of dj/tj vs. inherited tʃ/dʒ (< kw, gw). 
{d j;t j} > {d͡ʒ;t͡ʃ}

$TODO NOTE FOR DIA: although phonemic nasalization is assigned a later point in the relative chronology (DV1737, number 8), it may be necessary here at least for /e/ and/or /ɛ/, to block ietation and allow the merger of DV2.2.1K with DV2.2.1L1 & DV2.2.1M (aka the merger of 5b.1 with 5b.2 and 5b.3)

$DIACLEA INSERTION: before diphthongization/ietation (of the round elements), front round y and ø seem to retract before n and ɲ (e.g. Latin words in -ōnem > PAlb *uo, axungia > MPA ˌɑksˈyɲjɑ > ashunjë not *ashynjë and likewise in sanguisungia, words in -onju > PAlb *uo as well; ikone > korë; immūne > mû; luntrem > lundër not lyndër (via i-mutation), etc... ) but not m or ŋ (iunctura > yndyrë, iūnctus > gjymtë, pōma > pemë, brūma > brymë, etc...), and also not when in jø (ratiōnem > arësye etc.) 
	$TODO: however, note that of hte 13 cases here (not counting arsye which ends up fronted otherwise), 3 are cases where the fronting would be due to i-mutation that could be blocked by labials ( cāpōnem > kapua, pāvōnem > pallua, timōnem > timua), 1 is probably in a later layer (īconem > korë), 3 are possibly velars bleeding i-mutation (falcōnem drancōnem lacōnem > fajkua, drangua, lëkua), and one has an apparent resuffixation (rōsupōne > rozhponjë). Of the remainder, only leōnem is originally with [ˈo] at this stage; the mere four  that remain (immūne > mu , luntrem > lundër, sanguisungia > shushunjë, axungia > ashunjë) are all with u. Consider reformulating this. 
[+front,+round] > [-front,+back] / [-front] __ [+nas,-lab,-back]

$IETATION and DIPHTHONGIZATION follows. 
$DV2.2.1K and 1737's 5b -- diphthongized ietation -- ɛ (< PPAlb e, Lat e & ae) > ie before "word-final ɫ, r" ; he also attributes this to *e
$his ɫ is "lː" here though and his r is simply a short r so it is a diagonal grouping in terms of length, hard to capture in a feature matrix. 
$it says word-final but the falls of unstresesd vowels are actually assigned later (to word-internal and initial cases that is; the dating of the fall of final unstressed vowels isn't quite given in 1737-8 but one can assume this will happen to low vowels so this is added in : ([-lo,-stres] (m) ), the [m] being there to deal with the accusative (cf DV1737~2.2.2d) 
$ DIACLEA FIX: now using lˠ not lː
[+front,-hi,-lo,-round,+prim] > ˈi e̯ / __ {lˠ;r} ([-lo,-stres] (m)) #

$ DV1737's 5b.2 & 5b.3 : ø > ye and o > uo before word final -ɫ, -n, -r
$ these are also part II of DV2.2.1L1, L2 and 2.2.1M ... but the conditioning appears slightly different for those? 2.2.1M, generating PAlb *ye, is attriubted for "PPAlb. ō + i-mutation, Lat. jō" whereas the table earlier on 1737 treats all Lat & PPAlb ō as becoming ø̄ 
$ the blocking of fronting of PPAlb and Lat ō is currently implemented in "part I" of DV2.2.1L1 & DV2.2.1M, above, via merger into ɒː (which before long raises)
$ TODO check this ^
$ per DV2.2.1M, glided j gets absorbed into ø here. 
$ TODO check this^ IMPLEMENT FOR DIA -- remove the (j), because this is better handled via tj > tʃ > s. 
$ regarding the word-finality, same factors apply as above in DV1737~5b.1
$ DIACLEA FIX: now using lˠ not lː
{ˈo;j ˈø;ˈø} > {ˈu o̯;j ˈy e̯;ˈy e̯} / __ {lˠ;n;r} ([-lo,-stres] (m)) # 

$ DV1736's 5a.1 : *ɛ > jɛ ietation (my word)
$ = DV2.2.1B2 
∅ > j / __ ˈɛ

$ DV2.2.1B1 : but no ietation in the context CL __ 
j > ∅ / [-cont] [+cor,+son,-nas] __ ˈɛ

$DV1737's 5b.iv: *o > *uo/# __ {r,lj},
$this is also DV2.2.1L2 as concerns Latin o
ˈo > ˈu o̯ / # __ {r;l j;ʎ}

$DV1737's 5b.v: *ø > *ye / __ (w) V
$ formatted to allow /w/ to have become [β]
ˈø > ˈy e̯ / __ ([+lab,-syl,+cont,+voi]) [+syl]

$ a-mutation -- DV1736's 5a.2, also DV1735~ 2.2C2 + de Vaan 2004: 78--83. --  e (or ɛ it seems?) instances lower to a under the influence of /a/ in next syllable it seems. -- but per De Vaan 2004(78-83) this doesn't happen to Latin (and indeed the data largely matches this), and this is handled above in DV2.2.1C2. 
$[-hi,-round,+syl] > [+lo,-tense] / __ ([-syl])* [+lo,+syl]

$ DV2.2.1C3 -- Lat AU and PPAlb *au (falling diphthong of either w or ʊ̯ , the latter from the bandaid in late PPAlb) become a , but not early enough to trigger i-mutation (and likely also after contact with Proto-Vlach?)
[-syl,-cons,+round] > ∅ / [+lo,+syl] __

$ DV 1737's 6. ø > e; implements final parts of DV2.2.1B6-8.
[+front,-cons,-hi] > [-round,-lab]

$TODO, EPSILON NOTE: from this point onward, De Vaan uses *e, but the difference between *e and *ɛ is not meaningful (any longer), and the gold outcomes in ALLex feature /ɛ/, so we will have to at some point move (or merge) these to/as ɛ -- probably at the end.
$ likewise, for o and ɔ
$bandaid here thus inserted
[+syl,-lo,-hi] > [-tense]

$ DV 1737's 7. Unstressed word-internal vowels to schwa, unstressed initial to zero-- include in _- VOWEL DROP WAVE -_


$DIACLEA INSERTION: h is deleted after vowels and before non-stressed vowels except before stressed vowels (later insertions hard to characterize; some role of r?) 
h > ∅ / __ [-stres]
h > ∅ / [+syl] __
$∅ > h / # __ [+stres] r

$ --- Second wave (as originally written) of early vowel reduction phenomena here --- 
$_- VOWEL DROP WAVE -_
$ TODO: currently considering moving the initial syncope wave to this area (currently rule 35, resolving in rule 38); make a note if you do.  

$ DV2.2.2a -- in absolute initial position, all vowels reduce to schwa, on their way to zero (except in __ RC in Buzuku) 
$ TODO FOR DIA consider suppressing the Buzuku rule here. 
[-prim] > ∅ / # __
∅ > ə / # __ [+son,+cons] [+cons]

$ DV2.2.2b -- internal pretonic vowels "including *au" (now > *a per DV2.2.1C3) to schwa, some of these to fall soon. "These reductions also affected the oldest layers of loanwords from Middle Greek, Italian, and Slavic" -- so will be repeated later just after the point for Old Northern Tosk Albanian. 
[-prim] > ə / @ __ (@)* [+prim]



$ ------- secondary cluster formation---------------


$TODO the various unstressed vowel drops occur somewhere around here. -- this is 1737 "7.", and covered extensively in 2.2.2 


$In 2.2.2b, it is unclear what determines the drop of pretonic schwa, but based on the given examples, conditions for drops at this stage include...
	$ (i) n __ C with assimilation of the /n/ (mbesë < nepōtia; shëndet < sanitātem), 
	$ (ii) k ə t > f t. -- This latter one will be handled in the later kt > ft shift as "2.2.2b.iii"
$ note that some are dropped later -- note Early Modern Tosk vëllezër, vullëndet, mallëkon "to cures", arësye "reason" etc.
$ part i, schwa deleted between n and stops.
$ DIACLEA CORRECTION: while preserving the deletion of ə between n and T, even word initially, it is extended to m, also even word initially
ə > ∅ / [+nas,+cons] __ [-cont]
$ DIACLEA CORRECTION: also, pretonic NəN to NN if there is a consonant beforehand (i.e. not inimicus > armik)
ə > ∅ / [+cons] (@)* [+nas,+cons] __ [+nas,+cons] (@)* [+prim]
 
$TODO FOR DIA -- want to handle place assimilation of the n here too -- like: n (ə) > [αant,βcor,ɣlab,ðhi,ɛback,ɸfront] / __ [-cont,αant,βcor,ɣlab,ðhi,ɛback,ɸfront]
	$ note that m does NOT assimilate in this way : emtë, kumt, kumtër... 
	$ however it does eject a place-assimilating -n- initially before t (metaxum > mëndafsh, matricula > (më-?)ndrikull) and maybe ɟ (magia > mëngji?) ... or just things that aren't ð which will soon disappear (perhaps generalize to β, maybe even ɣ...) 

$DIACLEA CORRECTION: schwa deleted in R/N m ə N (qerm, kungoj, kernjoj, kulm -- not elsewhere, see as seen in the flapping in femër, numëroj < nomin-ā-, djemër, timër) 
ə > ∅ / [+son,+cons] m __ [+nas,+cons]

$ end of this wave of vowel drops _- VOWEL DROP WAVE -_

$ regressive obstruent devoicing assimilation on v (< De Vaan's PAlb β < w- DV1744.B6 = DV4.2I6 -- vicinus > fqinj) but simpler to handle this way without an unnecessary β step). Can be broadened for others that this is implied for (praebyter > prift, etc)
$ will be reversed by post-nasal stop voicing below. 
[-son] > [-voi] / __ [-voi] 

$ DV1744.B5-- k > f before t (in places not touched by rule of DV1744.J3) --- 
$ this includes initial position after the loss of unstressed first syllable vowels (he gives cotoneus > ftua as an example) 
$ DV1744.B4 -- also k > f before s with same qualifications. 
$ this can be jointly handled with the same development before /s/ (which is understood to not yet be ʃ)
$ and the same development for pt to ft (DV1744.B3), which also absorbs (b) implying a regressive devoicing in praebyter > prift (example given in DV1744.B3) 
$ k > f aspect is bled before front vowels by k > j phenomena it seems (DV1744.J3)
$ De Vaan does not include ps > fs(h) -- data seems inconsistent as there is gripsa > grifshë but psh- outcomes in supsīritāre > psherëtij and supsīrium > pshirë. 
$ handling DV2.2.2b.iii (kˌət  >ft ) here too. 
p > k / __ t
{k ə;k} > {f;f} / __ {t;s}

$ post-nasal stop voicing. De Vaan attributes this to Proto-Albanian, for Latin and native words alike for -p- (DV1743.B2, .B4) and -t- (1743.D2 = 4.2D2), while treating Latin loans alone for k > g / n __ (DV1744.A1, .A3)
	$ De Vaan's handling of /p/ is given the same time betweeen native and Latin strata, but not the
		$ same conditioning environment. 
	$ TODO need step to preserve Latin/non-Latin differences if this if expanded for PIE > Alb run.
$ he handles nt > nd together for native and Latin, with the conditioning "n __ in  a pretonic or stressed syllable"; his examples also include cases where it is the coda of a stressed syllable (dhëndër, kundër), and those where it is the onset
$ This is placed into the period before the earliest Slavic loans enter as benefit of the doubt, since that's still Proto-Albanian for De Vaan. (except by technicality the proposed precocious pre-rhotic Slavic loans, if they are considered to be a legitimate layer) 
$ TODO note however the possible case of Angevin encant > ankand (Marr 2023) 
t > d / n __ ([-syl])* [+stres]
t > d / [+stres] ([-syl])* n __
$ mp > mb and nk > ng everywhere they occur.
[-cont,-cor] > [+voi] / [+nas] __ 

$DV4.1N (=DV1742I) OAlb f < PAlb θ / C __, including OAlb ënfle -- cf Matzinger 2006: 71 -- Matzinger, Joachim. 2006.  Altalbanische Text Mbsuame e Kreshterë (Dottrina cristiana) des Lekë Matrënga von 1592. Eine Einführing in die albanische Sprachwissenschaft. Seems to be in all dialects? 
θ > f / [+cons] __

$DV4.2E & DV4.2F3 -- wave of palatalization, occuring before front vowels, including fronted former long round vowels (y, ø) but not including reduced vowels.  Absorbs /w/. 
w > ∅ / [+back,-cont] __ [+front,-lo,-cons]
[+back,-cont] > [-back,+front] / __ [+front,-lo,-cons]

$DIACLEA insertion: A2.XIV. Latin /s/ voices to /z/ rather than going to /ʃ/ before at least m and z (exmulgia > zmojle, crisma > krezëm, crismāre > krezmoj, exvigilāre > zgjoj, scabies >zgjebe, scoria > zgjyrë) but not /l/ (slucus > shluk). Right now maximally assume it happens before all voiced consonants. Has to happen after i-mutation (if that's source of hte voicing scabies and scoria) and the syncope ofthe -i- exvigilare.
s > z / __ [+voi,+cons,-lat]

$ DV1744.H ~ s becomes ʃ -- for s in reflexes of Old Greek (presh < prason), Latin, and the earliest Slavic loans (grusht, shkrap) becomes ʃ (1744.H) -- but this is not fed by tʃ becoming s (DV1744.F and 1744.G) 
s > ʃ

$DV2.2.1C5: Latin short e > a in "q, sh" __ "rr, l". No explicit word on the dating of this except that it is between post-Latin PPAlb, and PAlb; the forms used (q, sh,... rr, l) suggest a later date but at first inspection it seems to precede the merger of ae to short e (caelum > qiell) which certainly must have been before k > q (=[c]). So it is placed right after "rr, l" emerged (with what would become dark l now being long l, and rr being long r)
$Per its current placement after ietation, a j is imposed, and ˈɛ is used. 
$no clear way to block this for PPAlb *e, so this will need to be fixed if errors arise (TODO) 
ˈɛ > ˈɑ / {k;[+cor,-lab,+cont]} __ {l;rː}

$bandaid -- fronting of remaining low vowels at this point, because the lexicon has modern Albanian low vowels as front. 
[+lo] > [+front,-back]

$ -------- rise of long vowels -------
$ De Vaan places this between Proto-Albanian and modern PAlb but it seems clear that it is intended to represent a pan-Albanian development
$ moved to before vowel drops tentatively for DIA as of 8/14/23 because this includes the loss of vowels in R __ T that seem necessary to block effacement of d and rather its passage to /ð/ in cases like laridum and viridem (> lardh, verdh) 

$ DV1734.1.I -- long vowels that arise through "internal contraction" 
$previously assumed this meant with schwa and/or homoorganic vowels for now, put per conference with De Vaan 8/9/23 -- to be on the safe side do it for all vowels; 
$ version before 8/5/23: 
	$ {ə;ˌə;[-prim,αhi,βlo,ɣround,ðfront]} [+syl] > ∅ [+long] / @ __ @
	$ [+syl] {ə;ˌə;[-prim,αhi,βlo,ɣround,ðfront]} > [+long] ∅ / @ __ @
$ had to change to sidestep input-side issues then-current in DiaSim. TODO consider restoring. 
$ version before 8/9/23 was these four rules, before changing implementation to cover all vowels that have come into contact
$	[-prim,-lo,-front,-back] [+syl] > ∅ [+long] / @ __ @
$	[-prim,αhi,βlo,ɣround,ðfront] [+prim,αhi,βlo,ɣround,ðfront] > ∅ [+long] / @ __ @
$	[+syl] [-prim,-lo,-front,-back] > [+long] ∅ / @ __ @
$	[+prim,αhi,βlo,ɣround,ðfront] [-prim,αhi,βlo,ɣround,ðfront] > [+long] ∅ / @ __ @
[-prim] [+prim] > ∅ [+long] / @ __ @
[+prim] [-prim] > [+long] ∅ / @ __ @

$DV1734.1.III compensatory lengthening
$ based on examples in DV2.2.2b and 2.2.2c, posttonic vowels seem to be lost at this point in the context R __ T, with lengthening of a prior vowel if it is stressed. (amita > emtë, manica > mëngë, veritātem > vërtet , spīritus > shpirt; vs. orphanus > varfër, epíscopus > peshkëp, contrā > kundër, tjetër < -étero-, sherbëtuor...
$ lengthening aspect implemented first 
$ --not near -ll- it seems so -long,-back to be safe :  maledicere > mallëkoj but also mallkoj?; likewise voluntātem > vull(ë)n(d)et ; note also Buzuku's sonëte -- but there might be analogical-lexical reasons for that as it is so - nate?) 
$TODO reexamine this? 
[+prim] > [+long] / __ [+cons,+son,-long,-back] ə [-cont]

$syncope aspect of DV1734.1.III implemented below; this is also DV1734.4
ə > ∅ / [+cons,+son,-long,-back] __ [-cont]

$DV1734.1.IV -- 'lengthening before nasals, liquids, sibilants'
[+prim] > [+long] / __ {[+cons,+son];[+strid]}

$   ------------- INTERVOCALIC STOP EFFACEMENT (AND CLUSTER SIMPLIFICATION?) -----------
$ TODO figure out how to handle this in the base cascade? -- probably have it here after the fall of schwa in R __ T, with a (more concise) explanation
$ TODO try out the cluster simplificaiton aspects, and see then if they match what Orel said. 

$ effacements of intervocalic stops and /w/ follow (I'd note they were perhaps all phonetically fricatives at the time they were effaced, cf Pope 1934 on Latin /w/ as [ɣʷ], as noted in BaseCLEF) 

$ effacement of intervocalic /d/, per De Vaan 2018(: 1745 -- DV1745.A4) 
$	$ He asserts that native Proto-Albanian */d/ had a different fate in the same environment, 
	$	becoming /ð/ only after /d/ in Latin words was effaced, 
	$	with the same also occuring for both native and Latin /d/ in V__r (see De Vaan 2018: 1744)
	$ per p1745, he does explicitly propose that Latin intervocalic /d/ also became [ð] before disappearing, 
	$	but before this happened to native intervocalic /d/, and both in V r __ . 
	$ De Vaan 2018(: 1743) also explicitly asserts these passed trough a stage of *ð. 
$ $ note that this account is rival to Orel 2000(:105)'s view that Latin D shared the fate of Proto-Albanian *d in both V __ V and r __ Vs
$ $ The etyma cited by De Vaan 2018 as evidence for this are counterexplained 
	$ for gjyq, bekoj and jek -- by the view that voiced stops were effaced in secondary clusters caused by the internal vowel loss  
		$ cf. Bonnet 1998(:166) 
	$ and for fe and pre being counterexplained as possible later Angevin loans (Marr 2023) 
	$ counterexamples noted by Orel 2000, Bonnet 1998 and Marr 2023 include modh < MODVS, prodhoj < PRŌDĀRE, predhë < PRAEDA, adhuroj/adhëroj < ADŌRĀRE
$ possible other exceptions in the data: 
	$ ohter cases in the data : kudh (<(IN)CUDEM), kudhër (< INCUDINEM), perhaps predhë, also edh (<HAEDVS) perhaps;
		$  perhaps also medicastrum > mëgashtër may have had the -d- survive to motivate the voicing via progressive voicing assimilation . 
			$ likewise excaudic-ā- > shkaGoj
	$ there are cases where on the surface these appear to be properly effaced -- though it seems many are where vowel drops should be, in line with the views of Orel 2000 and Bonnet 1998 that the drop of /d/ (as well as /ɡ/ and /b/) is due to the clusters formed with fall of unstressed vowels 
	$ However in any case this clearly should be later if it happens at all, because (a) it is not seen in shared vocab with Romanian (padure, etc.), and more importantly (b) it is clear that cases that De Vaan doesn't seem to consider intervocalic -- laridum and viridim -- and which are unaffected (becoming lardh and verdh, respectively) -- thus, intervocalic stop effacement is moved to after vowel this based on DIA evidence, to allow DV1744.E4 to be fed first by internal vowel drops, and to allow them to bleed the -d- effacement after /r/ (and potentially feed it in other cases, if we go with the views of Orel 2000)
d > ∅ / [+syl] __ [+syl]

$ DV1744.E4 -- Latin d becomes edh after r (as with PPAlb d -- DV1744.E2) 
d > ð / r __

$ De Vaan 2018 (: 1745.A4) -- Latin /b/ is deleted both (DV1745.A2) intervocalically and (DV1745.A3) in V __ r 
	$ he explicate the prior vowel in DV1745.A3 (it's just " __ r") but all cases he lists 
	$ are actually V __ r V, and I don't think Latin has any C b r C strings, let alone those that would have made it into Proto-Albanian 
	$ for (b) he lists farkë "smithy" < FABRICA, OGeg fëruor "february" < FEBRUĀRIVS, kushëri "cousin" < CŌNSOBRĪNVS, harr-o- "to  forgot < ABERRĀRE
	$ for (a): buall "buffalo" < BUBALVS, djall "devil" < DIABOLVS, i/e lirë "free" < LIBER, kut "elbow" < CUBITVS) 
	$ the cases of bubalus > buall, diabolus > djall, liber > lirë and perhaps fabrica > farkë suggest that for De Vaan 2018, this should be placed before the loss of unstressed posttonic internal vowels -- unlike the case with /d/ (i.e. laridum > lardh) [though for DIA this has now been moved] 
b > ∅ / [+syl] __ (r) [+syl]


$ --- end of intervocalic drop block ----
$ TODO -- can remove this TODO when handled other experimenting with other cluster simplifications and then checking if they match those of Orel 
$ TODO -- need to shift this again so that it comes before the INITIAL vowel drops! edictare > hetoj etc. 
$ TODO make note in DiaSim fixes file. Need to be clear but concise. 
$ TODO currently placed this before the drop of final vowels, since those seem to be counted as intervocalic for De Vaan -- TODO decide on where to put this in the baseline files, and explain it concisely but clearly.


$ ---------- Pre-Slavic final vowel effacement phenomena -- 

$DV1738, top, part 1: final -V(s) and -oi (> ī ?) without stress fall 
$in effect, this is non-low-vowel unstressed final syllables closed by inflectional endings. 
$form prior to 8/5/23 was: [-stres] {m;s} > ∅ / __ #
$changed to sidestep then-current input-side issues in DiaSim. TODO consider restoring when these are resolved. 
$ note that -stres implies a vowel if we are using the default feature definitions and implications (as is intended for this cascade), as the feature [stres] is unspecified unless it is [+syl] 
$DIACLEA CHANGEː -n also deleted. 
{m;n;s} > {∅;∅;∅} / __ #
[-stres,-lo] > ∅ / __ #

$DV1738, top, part 3: final -ja(s) to e, clearly bleeding part 2 below. 
$form prior to 8/5/23 was: j a (s) > e / __ #
$changed to sidestep then-current input-side issues in DiaSim. TODO consider restoring when these are resolved. 
{j a s;j a} > {e;e} / __ #

$DV1738, top, part 2: final -a(m/n)(s) to ë 
$form prior to 8/5/23 was: a ([+nas,+cons]) (s) > ə / __ #
$changed to sidestep then-current input-side issues in DiaSim. TODO consider restoring when these are resolved. 
{a m s;a n s;a s;a} > {ə;ə;ə;ə} / __ # 

$DV1738, top, part 4: final -a + jˌa (def FSG) > a 
a j > ∅ / __ ˌa #

$DV1738, top, part 5 -- final countertonic -is, -ei (def rt msg) to >i, but it appears this is accomplished by other rules. TODO check this if necessary. 

$DV1738, top, part 6: final -i without primary stress (effectively countertonic) > -u after velars. (but in practice this will be mainly be the (secondarily stressed?) -u of the definite masculine nominative?) 
[+hi,+front,-prim] > [-front,+back,+round,+lab] / [+back,-cont] __ #



$ -----------cluster simplification----------
$ ----------NASAL CLUSTER SIMPLIFICATION-----

$DIACLEA INSERTION: A2.VI; final nasal clusters resolve in favor of the first element, with no particular evidence of lengthening (Unlike A2.VII). Cases: scamnum > ... >> shkëmb, stamnum > ... > (Gheg?) shtam, damnum > ... > dëm, pignus > ... > peng, terminum > *tjɛrəmənə > tjermn (cf. A1.I) > ... > qerm, signus (insignē?) > ... > sheng. There seems to be an alternate outcome for mn in -më, and for ŋn in -ɲə (një), but the conditions are unclear except that it only happens after vowels, and this is not implemented for now (exāmen > shemë, flāmen (or flāminem?) > flamë, dignus > denjë...). 
[+nas,+cons] > ∅ / [+nas,+cons] __ #

$DIACLEA INSERTION: A2.VII. pretonically primary and secondary sequences of nasals alike resolve to the second element; at least when it is /n/ the result is a long /nː/. It seems there are two rounds of this. Examples: carmināre (> karmini-ā- due to ina - inia phenomena) > kernjoj; (gn = ŋn remember) sign-āre > shënoj, cognatus > kunat, damn-āre > dënoj, communic-āre > kungoj. This will also potentially handle homorganic nasals, if they have emerged. 
$ Since all other cases have been handled by the above rule concerning final nasal clusters, there is no need for a context, but if there was one it would be -- / __ ([-stres])* [+prim]
[+nas,+cons] [+nas,+cons] > ∅ [+long] 
[+nas,+cons] [+nas,+cons] > ∅ [+long] 

$DIACLEA CORRECTION: postalveolars and palatals absorb following yod
j > ∅ / [+front,+cons] __ 

$DIACLEA CORRECTION: n (and perhaps long n) assimilates in place to following labial stops, palatal stops, and velar stops. Does not happen for affricates.
$[+nas,+cor,+cons] > [-cor,βlab,ɣback,ðant,ɩfront,χhi] / __ [-delrel,βlab,ɣback,ðant,ɩfront,χhi]
$ TODO unfortunately this rule is on hold because of a bug. 

=Late Proto-Albanian

$------- continued rise of long vowels -------------
$DV1734.1.II -- long vowels that arise through contraction in final position with *-ë and -i, the latter with apparent fronting but while illustrated in provided examples this apparent fronting is not stated as part of the development by De Vaan 2018, because it can be handled anyways by i-mutation. Gheg preserves -aë# and -oë# longer and makes them into vowels in some dialects ([æ], [ø]), so this is placed after the split of Proto-Albanian 
$ this rule is formulated to capture not only non-primary stressed i and ə but also e -- this is simpler and has no issues as far as I'm aware -- TODO examine this for errors if necessary though. 
[+syl] [-prim,-round,-lo] > [+long] ∅ / __ #

$DV4.1V3 -- lk > jk -- some variation (bujk/ bulk for "peasant", OAlb attests ulk) but seems (??) pan-Albanian in nature? 
$$ dialectal evidence suggests that this originally first passed to ʎ: Huld 1976 p 197 for ujk shows that uʎk- forms in Arvanitika and Arbereshe (Sal, Vacc, Falc), and Huld reasonably asserts proto-Albanian had either or uʎk- or ulk- when it split. This is perfectly compatible with hte rest of De Vaan 2018 (which has ʎ go to j later), and is not a new conclusion, so the version supported by Huld is implemented here for now.
$MOST FAITHFUL VERSION: l > j / __ k
l > ʎ / __ k

$DV4.1E2 & DV4.1F2 -- iotation of l after velar stops. This does not occur in some southern varieties, such as Cham and some Arbereshe dialects, so it could be that it occurred after Proto-Tosk split (in the broad sense, i.e. Proto-Southern-Albanian), or that Proto-Southern-Tosk retracted *ʎ to *l after velar stops. The outcome in Arvanitika is ʎ; in Arvanitika (and the other varieties where ʎ occurs after velars?), ʎ elsewhere appears to be preserved -- cf. Arvanitika biʎë "daughter" noted in De Vaan 2018 (:1740).
$ DV1743.F5 -- -c(u)l- > c > ɟ if after nasals in ungj < avunculus -- effectively handled here and with the earlier voicing of k > g in the earlier Middle Proto-Albanian post-nasal voicing shift.
l > ʎ / [-cont,+hi] __

$ DV4.1B2 : b inserted between m and the word bound.-- cf. also Bonnet 1998: 195
$ DIACLEA: suppressed. Not worth the errors. TODO consider reinstating with finer grained conditioning.
$ ∅ > b / m __ #

$ vowel nasalizations -- last of major vowel developments per DV1737 
$ implementing: DV2.2.1G1-2, DV2.2.1H1-2, DV2.2.1I1-2, DV2.2.1J1 
$ although nasalizations of ỹ, õ are not explicit, they are not explicitly excluded either, and it is simpler in terms of rule formation to include them. TODO reexamine this in case it may cause problems.
$ DIACLEA CORRECTION: this also seems to happen word finally, including after uo̯ (though cases of uon don't seem to show any sign of overt nasalization *anywhere* unless I'm missing something -- so point at which it is deleted in Gheg there may need to be ascertained). 
$ [+syl] > [+nas] / __ [+nas,+cons] -- BaseCLEA18 version
[-cons] > [+nas] / __ [+nas,+cons]

$ Nasal vowel + nasal consonants become simple nasal vowels at some point. This does not seem to be explicated by De Vaan 2018, but it is implicit in some examples -- gju / Gheg gjû < glun-; Gheg lĩ < līnum, fqĩ < vicīnum, frẽ < frenum. Native vocab also show a pre-sibilant coalescence (mëz/mãz, pesë/pẽsë -- unclear if that z is still an affricate or not, so just do this in terms of stridents?). So we insert that here for now. These all concern only n, so only n is used in the formulation of this rule. Given the case of ftua < cotoneum one can generously allow this to happen not just for syllabics but also after nasalized glides, or glides after a nasal vowle (however uo's nasalized incarnation ends up being realized here, it is intended to be captured with this following rule formulation) 
$ DIACLEA TODO NOTE: after uo and perhpas a, this does not happen word finally in monosyllabic words... but there are only two examples luan and plënd. IF intend to implement it this way, use: 
	$n > ∅ / [+syl,+nas] __ #
	$ n > ∅ / [+syl] ([-syl])* [+syl] [-cons,+nas] __ #
n > ∅ / [-cons,+nas] ([-cons,+nas]) __ {[+strid,+cons];#}

$ DV4.1W2 = DV1742R2 -- h prosthesis from PAlb into modern Alb. 
$ may not be deterministic (may have originated in hypercorrection), but per conference with De Vaan- - inclusion so as to test it (8/9)
$ TODO note for DIA -- many examples actually have an /r/ after the vowel... (hark, harmëshor, harron...) 
$ Placed pretty early as affected words seem to be pretty widely so
$ DIACLEA : suppressed
$ ∅ > h / # __ [+syl]

$DV3.1A2 -- "PAlb. β" to m before "VN$". 
$Some ambiguity of dating of this rule -- this is placed between Proto-Albanian and modern Albanian, but the wording of this rule assumes beta has emerged but has not yet passed to /v/ (all the cases listed are where beta reflects Latin /w/), and it also assumes the /n/ is still present in this ve:nsi:ca despite nasal-spirant stuff that happened quite early... unless this word was loaned in another wave? Some examination may be necessary.
$Syllable break handled with a consonant for now. This may need to be examined but has no issues at present. 
$ DIACLEA -- SUPPRESSED. This will have a different and earlier explanation in MPA.
$[+lab,+cont,-syl,+voi] > m / __ [+syl] n [+cons]

$ DV4.2T = DV1742O -- labiodentalization of β
$ incorporating ɸ here too. 
$ placed between PAlb and modern Alb by DV´18 but could probably be placed earlier as this does seem to be pan-Albanian? 
$ Furthermore, earlier placement may be warranted in case the reflex of *β seems to pattern with /f/ in terms of -kt- clusters, where /f/ seems to pattern differently than /p m/...
[+lab,-son,+cont] > [+strid]

$DV4.1U2 = DV1742P2 -- voicing assimilation of ʃ before voiced consonants to modern ʒ -- has to be before end of the fall of lenited stops (in this case β) 
$DIACLEA fix: now only happens before obstruents as there are exceptions for at least /l/ and possibly other resonants. In reality this may be morphological though, as it only seems to happen to the prefix sh- "dis, un" 
ʃ > [+voi] / __ [+cons,+voi,-son]

$ dʒ and tʃ pass to z and s -- whether from PPAlb dʒ/tʃ or from reflexes of Latin loans in dj-, tj (DV1744.F1 = 4.2M1, 1744.F2 = 4.2M2, 1744.G1 = 4.2N1, 1744.G3 = 4.2N3)
$ This effects also the earliest Slavic loanwords : e.g. poroçit > porosit "to request", sul "small boat" , etc. 
[-ant,+distr,+delrel] > [+ant,-distr,+cont,-front]

$ DV4.2P *x to *h -- this is listed as a PPAlb to PAlb change, but it is placed here as it also seems to effect Slavic loans as well, and has somewhat different outcomes in (some) Gheg where Tosk -h ends up corresponding to Gheg -f  
x > h 

$ DV4.1B3 & Bonnet 1998:193 -- *Tosk* insertion of b between m and unstressed vowels
$ DIACLEA CORRECTION: the places this actually correctly happens seem to be before laterals -- grūmul-ā- > grumbulloj, meletta > (m)bletë (?), similatūra > shëmbëlltyrë
	$ but not word initially: maledīc-œ > mallkoj, maliti-ā- > malcoj, molārem > mullar, molīnum > mullî, mulc-ē > mëlkoj  maluang-œ- > mallëngjej. 
	$ accuracy gained with this fix: +0.8%
∅ > b / @ m __ [-stres] [+lat]

$DV3.1G1 : Tosk rhotacism -- "dated 800-1000 CE, Janson 1986: 190-211". 
$ TODO NOTE FOR DIA : note that this may have to precede some vowel drops though -- note the example inimīcvs > armik (which is given by DV'18: 1739), though maybe ə was retained between n-m (note cited form anëmik) 
$ DIACLEF CORRECTION: between high vowels and final ə this does not seem to normally happen (furtunë, shpinë, kurtinë, kaptinë, trinë, tinë; exception -- rrëshirë). Block via gemination
n > nː / [+syl,+hi] __ ə #
n > r / [+syl] __ [+syl]

$DV3.1H2 : -rn- > -rr- / V __ V . This happens in Gheg and Tosk, but De Vaan 2018, citing Janson 1986(:97f), argues it is post-Slavic. Inasmuch as it happens in Gheg, it is also independent of Tosk rhotacism, and should thus be handled separately.
r n > rː / @ __ @

$DV3.1E -- l: passes to dark l.
$ This is actually pan-Albanian but it is placed as a PAlb to Modern Alb change DV'18. 
$ TODO consider moving it earlier, or doing away with l: entirely and instead work with dark l
$ DIACLEA CORRECTION: deleted. Consolidated as the /l:/ stage never happens now. 
$lː > lˠ

$DV3.1B2 n: to n
$DIACLEA CHANGE: expand this to the shortening of all long nasals. 
$nː > n
[+nas,+cons] > [-long]

$BANDAID fix-- since the notation of the data uses ɾ and r not r and rː, this is implemented here, even though DV2018 has a modern Alb r and rː 
r > ɾ 
rː > r

$ ã raises to ə in Tosk (ultimately denasalizing to ë outside of some Lab subdialects which may (or may not) have preserved nasality, maybe for this item) 
[+lo,+nas,+syl] > [-lo,-back,-front,0tense]

$DV2.1D2 -- Tosk uo > ua ; written agnostically as to the syllabic status of the a. 
[+back,-cons,-hi] > [-back,+front,+lo,-round,-lab,+tense] / [-cons,+round,+hi,+back] __

$DV2.1F2: və > u- 
$ this might be yet earlier considering that it also happens in Gheg? Or not. 
{v ə;v ˌə} > {u;ˈu} / # __

= Proto-Tosk

$loss of vocalic nasalization: DV2.1A2, C2, completing E1, F3
[-cons,+nas] > [-nas]

$TODO FOR LAB,CHAM,ARB-,ARV- : y > i here -- DV2.1A3 

$DV4.1R2 -- final devoicing of -z
$ DIACLEA: suppressed. Correct only for medius > mes, which has a doublet medius>mjez ; mes may have evolved that way for syntactic reasons anyways. 
$ z > s / __ # 

$DV4.1V2 -- ʎ passes to j. This happens across Northern Tosk and most Lab (?) but not in some other isolated southern varieties like Arbereshe. It also seems to have affected all of Gheg but the distribution in Tosk suggests it happened in parallel later, rather than being a true shared development. 
ʎ > j

$DV4.1E / -F -- beginnings late medieval central Albanian palatalization. This effects the reflexes of cl,gl- for all Tosk. Before front vowels, it also affects all of Northern Tosk, as well as Southern Gheg and much of Northern Gheg (more northeastern) but also effects the earlier waves of Turkish loanwords, so this part of it is placed later.
[+back,-cont] j > [-back,+front] ∅

$DV4.1J : z > dz after n 
z > d͡z / n __

$DV4.1V6 -- *c *ɟ ɲ to j before a consonant ; cf. Schumacher 2013ː 275-6. This is more characteristic of Gheg however it seems so it is suppressed for now; in any case it is not really characteristic of the Tosk-based standard. 
$ [+hi,+front,-cor,+cons] > j / __ [+cons]

$DV4.1G2 -- c retracted back to k before __ V ʃ
$TODO consider motivating factors here... 
c > k / __ [+syl] ʃ 

$repeat of internal pretonic vowel reductions per DV2.2.2b (see above)
[-prim] > ə / @ __ ([-syl])* [+prim]
ə > ∅ / n __ [-cont]

$gleaned from DV1738, unstressed final -o(n) and -a(s) in loans from early Slavic, Italian and Greek are reduced to -ë
$ TODO FOR DIA : consider retracting this just to -o, and have the passage of unstreseed -a to -ë only here, as the -o > -ë phenomena in Byzantine/Bulgarian/Italian seem limited to feminines, in which it could be analogical.
$ DIACLEA CHANGE: move this just to o ɔ a becoming ə ə ə as this causes too many errors
{o;ɔ;a} > {ə;ə;ə} / __ #

$DV1734.3 -- loss of length in Northern Tosk (and much elsewhere except much of Lab) 
[+long] > [-long]

= Old Northern Tosk Albanian
$ circa 1250-- layers added after this point incl. Old Italian II, Old Venetian, Old Angevin, Byzantine II, Ottoman I, Old Serbian. 

$DV4.1E / F -- further palatalization, this time occuring before front vowels -- and affecting Turkish loans as well. This happens in all northern Tosk but that it affected Turkish loans implies a later placement in the relative chronology (in Gheg it dodges some parts of the northwest zone) 
[+back,-cont] > [-back,+front] / __ [+front,-lo,-cons]

$DV4.1I : Old Albanian d + s & d + th > ts 
$merge also DV4.1K2 : OAlb d + sh > ç
$ version before 8/5/23 was : d [+cont,+cor,βant] > ∅ [+delrel,-βdistr,+strid]
$ had to change because negative alpha values are not currently supported. 
$ TODO consider restoring old version when possible. 
	$ TODO DIA ANALYSIS : at present... no words are effected. Consider removal.
{d ʃ;d s;d θ} > {t͡ʃ;t͡s;t͡s}

$DV4.1K1 -- Old Alb ʃ >  before a consonant 
$DIACLEF ANALYSIS: for Latin loans at present, c [+cons] clusters are barely present (at the pivot point at this rule, only one was detected -- and it was an error), while "ʃ [+cons]" sequences... overwhelmingly don't go to "t͡ʃ ..." 
	$ in fact, as of Aug 15, tʃ for ʃ was the most common confusion, with 88% of errant words having it, and the error was particularly common after the word bound (43.6%), before /t/ (36.8%) and before /k/ (30%) 
	$ DIACLEF correction -- posterior context changed from [+cons] to [+cons,+nas]
ʃ > t͡ʃ / __ [+cons,+nas]

$DV4.1K3 partially implemented here -- Tosk standard does not have c > t͡ʃ everywhere, but does seem to have it when praeconsonantal (çfarë, etc.) 
c > t͡ʃ / __ [+cons] 

$DV4.1V5 -- ɲ to j "often between vowels and in final position". This is a pretty modern development within northern Tosk, and the variety underlying the standard (as are many Lab dialects? But may need to check that) but in many regional northern Tosk dialects it hasn't happened. Has happened in parts of Gheg? Anyhow it is unclear if De Vaan intends to treat this as a regular sound change. In ALLex there are a number of cases where ɲ survives intervocalically (Danjell, kunjoj, shenjë, gështenjë, linjë, mënjollë, mënjë, mushkonjë, mërqinjë, panjë, rozhponjë, shushunjë, tenjë) and a few it doesn't (incuneāre > ngujoj -- but this might be from ngul instead) 
$ in final position there are two cases where it survives in ALLex : CVNEVM > kunj "spike", VĪCĪNVM > fqinj "neighbor" -- these are both after high vowels, but leave that for the Dia- cascade 
$ DIACLEA insertion -- A1.III -- this DOES occur word finally after i (case of vicinum > fqinj could be analogical based on the plurals) 
ɲ > j / {[-hi];[+hi,+front]} __ #

$~ Standard Albanian

$following changes only for future dialect handling. -- DV8/9 -- "except for the nj > j in verb forms, none are in the *written standard*", many widely accepted in spoken standard Albanian  


$ increasingly in the 21st century spreading into Tosk; this is also DV4.1K3
$c > t͡ʃ

$ DV3.1B3 nd > n is listed for PALb to MAlb, but this is really mostly(? only?) Gheg so it is placed here for now
$ d > ∅ / n __

$DV1742.M1 h > f is more of a Gheg change (and probably needs to be more finely specified) thus this cascade does not implement it
$DV1742.M2 θ > f with listed Gheg ufull for Tosk uthull (and thjeshtër/fjeshtër < FILIASTER, whatever is made of that) seems transparently more Gheg, and is perhaps not intended to be deterministic and/or needs more fine specification, so currently left unimplemented. 